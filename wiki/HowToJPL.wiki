#summary Compiling SWI-Prolog for the JPL Java API
#labels Phase-Deploy

= Introduction =

The SWI-Prolog compiler needs to be recompiled (on most Linux distributions) for JPL to work, since JPL is not in the default-configuration and it needs libswipl compiled as a shared library.

However online documentation indicates that recompilation may be not necessary on AMD64/x86_64 platforms. Only compiling JPL may suffice.


= Details =

Get the source: http://www.swi-prolog.org/download/stable/src/pl-5.10.1.tar.gz

Extract the tarball and edit build.templ as follows:
Set PREFIX:
 * PREFIX=/usr
 * SUDO="sudo"
Select Packages:
 * export DISABLE_PKGS="ssl odbc xpce zlib"
Additional packages may be disabled (as long as JPL stays enabled, of course) or any of the 4 above may be enabled. However xpce and zlib are known to cause problems in some environments and are not needed for naproche anyway. 
And create a shared library. Add:
 * EXTRACFG+=" --enable-shared"

Make sure every one of the options above is uncommented.

Then run build.templ. (Despite setting SUDO in most cases the script needs to be called as root)

Afterwards there should be a "jpl.jar" in /usr/lib/swipl-5.10.1/lib and libswipl.so in /usr/lib/swipl-5.10.1/lib/i686-linux

For compilation of the java-sources the jpl.jar needs to be in the Classpath and java needs to be called as "java -Djava.library.path=.:/usr/lib/swipl-5.10.1/lib/i686-linux" (path to libswpl.so) 

Please note: While this will (probably) not overwrite any SWI-Prolog packages which were installed via package management, it will replace the symbolic links to swipl, swipl-ld and swipl-rc in /usr/bin.

Tested on:
 * Arch Linux, i686
 * Ubuntu Linux, i686